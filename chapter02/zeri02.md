## 2장. 아키텍쳐 개요

<br>
<br>

### 2-1. 네 개의 영역
***
표현, 응용, 도메인, 인프라스프럭처는 아키텍쳐를 설계할 때 출현하는 전형적인 네 가지 영역  
도메인 영역, 응용 영역, 표현 영역은 구현 기술을 사용한 코드를 직접 만들지 않는다. 대신 인프라스트럭쳐 영역에서 제공하는 기능을 사용해서 필요한 기능을 개발한다.  
예를 들면 DB에서 보관된 데이터가 필요하면 인프라스트럭쳐 영역의 DB 모듈을 사용하여 데이터를 읽어온다. 비슷하게 외부에 메일을 발송해야한다면 인프라스트럭처가 제공하는 SMTP 연동 모듈을 이용해서 메일을 발송한다.

<br>
<br>

### 2-2. 계층 구조 아키텍쳐
***
표현 -> 응용 -> 도메인 -> 인프라스트럭처  

계층구조는 그 특성상 상위 계층에서 하위 계층으로의 의존만 존재하고, 하위 계층은 상위 계층에 의존하지 않는다. 예를 들어 표현 계층은 응용 계층에 의존하고 응용 계층이 도메인 계층에 의존하지만, 반대로 인프라스트럭처 계층이 도메인에 의존하거나 도메인이 응용 계층에 의존하지는 않는다.  
표현, 응용, 도메인 계층이 상세한 구현 기술을 다루는 인프라스트럭처 계층에 종속된다는 점  

인프라스트럭처에 의존하면 '테스트 어려움', '기능 확장의 어려움'이라는 문제가 발생  
__DIP__ 로 해결

<br>
<br>

### 2-3. DIP
***
- 고수준 모듈 
  - 의미 있는 단일 기능을 제공하는 모듈, 예를 들어 가격 할인 계산이라는 기능
  - 고수준 모듈의 기능을 구현하려면 여러 하위 기능이 필요


- 고수준 모듈을 구현하기 위한 __하위 기능__ 
  - 고객 정보 구하기 : 저수준 모듈
  - 할인과 관련된 룰 실행하기 : 저수준 모듈


고수준 모듈이 제대로 동작하려면 저수준 모듈을 사용해야함  
그런데 고수준 모듈이 저수준 모듈을 사용하면 구현 변경과 테스트가 어려워짐

저수준 모듈이 고수준 모듈에 의존하려면?
__추상화한 인터페이스 사용하기__  

- DIP 주의사항
  - DIP는 단순히 인터페이스와 구현 클래스를 분리하는 정도를 의미하는 것이 아니라 고수준 모듈이 저수준 몯ㄹ에 의존하지 않도록 하기 위함이다


인프라스트럭처 영역은 구현 기술을 다루는 저수준 모듈  
응용 영역과 도메인 영역은 고수준 모듈  
인프라스트럭처 영역이 응용 영역과 도메인 영역에 의존(상속)하는 구조가 됨

<br>
<br>

### 2-4. 도메인 영역의 주요 구성요소
***
- 엔티티
  - 고유의 식별자를 가지는 객체
  - 자신의 라이프 사이클을 가진다
  - 고유한 개념을 표현
  - 도메인 모델의 데이터를 포함하며 해당 데이터와 관련된 기능을 함께 제공

- 밸류
  - 고유의 식별자를 가지지 않는 객체
  - 주로 개념적으로 하나인 값을 표현
  - 주소, 금액 같은 타입이 밸류 타입
  - 엔티티의 속성, 다른 밸류의 타입으로도 사용가능

- 애그리거트
  - 연관괸 엔티티와 밸류 객체를 개념적으로 하나로 묶은 것
  - 주문과 관련된 order, orderline, orderer 밸류를 주문 애그리거트로 묶을 수 있음

- 리포지토리 
  - 도메인 모델의 영속성을 처리
  - DBMS 테이블에서 엔티티 객체를 로딩하거나 저장하는 기능을 제공

- 도메인 서비스
  - 특정 엔티티에 속하지 않는 도메인 로직을 제공
  - 할인 금액 계산안 다양한 조건을 이용해서 구현하게 되는데 이렇게 도메인 로직이 여러 엔티티와 밸류를 필요로 하면 도메인 서비스에서 로직을 구현

<br>
<br>

### 2-5. 요청 처리 흐름
***

<br>
<br>

### 2-6. 인프라스트럭처 개요
***
표현 영역, 응용 영역, 도메인 영역을 지원  
스프링의 Transactional 어노테이션 참조

<br>
<br>

### 2-7. 모듈 구성
***
한 패키지에 가능하면 10~15개 미만으로 타입개수를 유지하려고 노력하는 편이 좋음  
이 개수가 넘어가면 패키지를 분리하는 시도를 한다.
