## 애그리거트와 트랜잭션
 - 애그리거트의 일관성이 깨지는 문제가 발생하지 않는 방법
 - 운영자가 정보를 조회하고 상태를 변경하는 동안, 고객이 애그리거트를 수정하지 못하게 막는다.
 - 운영자가 배송지 정보를 조회한 이후에 고객이 정보를 변경하면, 운영자가 애그리거트를 다시 조회한 뒤 수정하도록 한다.
 - 애그리거트 트랜잭션 처리 방식에는 선점잠금과 비선점 잠금의 두 가지 방식이 있다.
 
 #
 ## 선점 잠금
- 먼저 애그리거트를 구한 스레드가 애그리거트 사용이 끝날 때까지 다른 스레드가 해당 애그리거트를 수정하지 못하게 하는 방식
- 선점 잠금은 보통 DBMS가 제공하는 행단위 잠금을 사용해서 구현
- 선점잠금 기능을 사용할 때는 잠금 순서에 따른 교착상태가 발생하지 않도록 주의

#
## 비선점 잠금
- 비선점 잠금은 동시에 접근하는 것을 막는 대신 변경한 데이터를 실제 DBMS에 반영하는 시점에 변경 가능 여부를 확인하는 방식이다.
- 애그리거트 객체의 버전을 통해 관리

#
## 오프라인 선점 잠금

- 누군가 수정 화면을 보고 있을때 수정화면 자체를 실행하지 못하게하는 기능은 선점 잠금방식이나 비선점 잠금 방식으로는 구현이 어려운데, 이때 필요한 것이 오프라인 선점 잠금 방식이다.
- 여러 트랜젝션에 걸쳐 동시 변경을 막는다.
- 오프라인 잠금 해제가 안되는 경우를 대비해 유효시간을 가져야함
- 오프라인 선점 잠금은 잠금선점시도, 잠금확인, 잠금해제, 잠금유효시간 연장 네 가지 기능이 필요
