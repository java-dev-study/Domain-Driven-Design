## 9장. 도메인 모델과 바운디드 컨텍스트 

<br>
<br>

### 9-1. 도메인 모델과 경계
***
한 도메인은 다시 여러 하위 도메인으로 구분되기 때문에 한 개의 모델로 여러 하위 도메인을 모두 표현하려고 시도하면 오히려 하위 도메인에 맞지 않은 모델을 만들게 된다.    
하위 도메인에 따라 같은 값을 가리키더라도 다른 용어를 사용하는 경우도 있다.   
ex) 회원 도메인 - 회원, 주문 도메인 - 주문자, 배송 도메인 - 보내는 사람   
   
   모델은 특정한 컨텍스트(문맥) 하에서 완전한 의미를 갖는다. 같은 제품이라도 카탈로그 컨텍스트와 재고 컨텍스트에서 의미가 서로 다르다. 이렇게 구분되는 경계를 갖는 컨텍스트를 바운디드 컨텍스트라고 부른다.

<br>
<br>

### 9-2. 바운디드 컨텍스트
***
바운디드 컨텍스트는 모델의 경계를 결정하며 한 개의 바운디드 컨텍스트는 논리적으로 한 개의 모델을 갖는다. 예를 들어 카탈로그와 재고 관리가 아직 명확하게 구분되지 않은 경우 두 하위 도메인을 하나의 바운디드 컨텍스트에서 구현하기도 한다.   
  


- 주문 하위 도메인
  - 주뭉 바운디드 컨텍스트
  - 결제 금액 계산 바운디드 컨텍스트

- 카탈로그 하위 도메인 + 재귀 하위 도메인
  - 상품 바운디드 컨텍스트


  
- 여러 하위 도메인을 하나의 바운디드 컨텍스트에서 개발할 때 주의할 점
  - 하위 도메인의 모델이 섞이지 않도록 하는 것
    - 도메인 모델이 개별 하위 도메인을 제대로 반영하지 못해서 하위 도메인별로 기능을 확장하기 어렵게 되고 이는 서비스 경쟁력을 떨어뜨리는 원인이 된다. 
    - 한 개의 바운디드 컨텍스트가 여러 하위 도메인을 포함하더라도 하위 도메인마다 구분되는 패키지를 갖도록 구현해야함


<br>
<br>


### 9-3. 바운디드 컨텍스트 구현
***
바운디드 컨텍스트는 도메인 기능을 사용자에게 제공하는 데 필요한 표현 영역, 응용 서비스, 인프라스트럭쳐 영역을 모두 포함한다.   
도메인 모델의 데이터 구조가 바뀌면 DB 테이블 스키마도 함께 변경해야 하므로 테이블도 바운디드 컨텍스트에 포함된다.   
표현 영역은 인간 사용자를 위해 HTML 페이지를 생성할 수도 있고, 다른 바운디드 컨텍스트를 위해 REST API를 제공할 수도 있다.   
서비스 - DAO 구조를 사용하면 도메인 기능이 서비스에 흩어지게 된다면 도메인 기능 자체가 단순하면 서비스 - DAO로 구성된 CRUD 방식을 사용해도 코드를 유지 보수하는데 문제되지 않는다. 

<br>

- 한 바운디드 컨텍스트에서 두 방식을 혼합해서 사용할 수도 있다.
  - CQRS 패턴
    - Command Query Responbility Segregation
    - 상태를 변경하는 명령 기능, 내용을 조회하는 쿼리 기능을 구분하는 패턴
    - 상태 변경과 관련된 기능을 도메인 모델 기반으로 구현하고, 조회 기능은 서비스 -  DAO를 이용해서 구현할 수 있다. 
  - ex) 상품의 상세 정보를 보여주는 페이지
    - 웹 브라우저는 카탈로그 바운디드 컨텍스트를 통해 상세 정보를 읽어옴
    - 리뷰 바운디드 컨텍스트의 REST API를 직접 호출해서 로딩한 JSON 데이터를 알맞게 가공해서 리뷰 목록을 보여줄 수도 있다. 
  

<br>
<br>

### 9-4. 바운디드 컨텍스트 간 통합
***
마이크로 서비스와 바운디드 컨텍스트


<br>
<br>


### 9-5. 바운디드 컨텍스트 간 관계
***
바운디드 컨텍스트는 어떤 식으로든 연결되기 때문에 두 바운디드 컨텍스트는 다양한 방식으로 관계를 맺는다.   
가장 흔한 관계는 한쪽에서 API를 제공하고 다른 한쪽에서 그 API를 호출하는 관계이다.  
이 관계에서 API를 사용하는 바운디드 컨텍스트는 API를 제공하는 바운디드 컨텍스트에 의존하게 된다. 

  
두 바운디드 컨텍스트가 같은 모델을 공유하는 경우도 있다. 예를 들어 운영자를 위한 주문 관리 도구를 개발하는 팀과 고객을 위한 주문 서비스를 개발하는 팀이 다를 떄 주문을 표현하는 모델을 공유함으로서 주문과 관련된 중복 설계를 막을 수 있다.  

__이렇게 두 팀이 공유하는 모델을 공유 커널이라고 부른다.__

<br>

공유 커널의 장점은 중복을 줄여준다는 것이다.   

<br>

- 독립 방식
  - 서로 통합하지 않는 방식
  - 두 바운디드 컨텍스트 간에 통합하지 않으므로 서로 독립적으로 모델을 발전시킨다
  - 두 바운디드 컨텍스트 간의 통합은 수동으로 이루어진다
  - 외부에서 구매한 솔루션과 ERP를 완전히 대체할 수 없다면 두 바운디드 컨텍스트를 통합해주는 별도의 시스템을 만들어야 할 수도 있다


<br>
<br>



### 9-6. 컨텍스트 맵
***

  

<br>
<br>
