# 9 도메인 모델과 바운디드 컨텍스트 
## 9.1 도메인 모델과 경계 
한 도메인은 다시 여러 하위 도메인으로 구분되기 때문에 한 개의 모델로 여러 하위 도메인을 모두 표현하려고 
시도하면 오히려 모든 하위 도메인에 맞지 않는 모델을 만들게 된다. 
```
- 카탈로그 - 상품 
상품 이미지, 상품명, 상품 가격, 옵션 목록, 상세 설명과 같은 상품 정보가 위주 
- 재고 관리 - 상품 
실존하는 개별 객체를 추적하기 위한 목적으로 상품을 사용 
```
하위 도메인마다 같은 용어라도 의미가 다르고 같은 대상이라도 지칭하는 용어가 다를 수 있기 때문에 
한 개의 모델로 모든 하위 도메인을 표현하려는 시도는 올바른 방법이 아니며 표현할 수 없다. 
각 모델은 명시적으로 구분되는 경계를 가져서 섞이지 않도록 해야 한다. 
구분되는 경계를 갖는 컨텍스트를 DDD에서 바운디드 컨텍스트라고 부른다. 

## 9.2 바운디드 컨텍스트 
바운디드 컨텍스트는 모델의 경계를 결정하며 한 개의 바운디드 컨텍스트는 논리적으로 한 개의 모델을 갖는다.
바운디드 컨텍스트는 용어를 기준으로 구분한다. 
바운디드 컨텍스트는 실제로 사용자에게 기능을 제공하는 물리적 시스템으로 도메인 모델은 이 바운디드 컨텍스트 안에서 도메인을 구현한다.
여러 하위 도메인을 하나의 바운디드 컨텍스트에서 개발할 때 주의할 점은 하위 도메인의 모델이 섞이지 않도록 하는 것이다. 
바운디드 컨텍스트는 각자 구현하는 하위 도메인에 맞는 모델을 갖는다.

## 9.3 바운디드 컨텍스트 구현 
바운디드 컨텍스트가 도메인 모델만 포함하는 것은 아니다. 바운디드 컨텍스트는 도메인 기능을 사용자에게 제공하는 데 필요한 표현 영역, 응용 서비스, 인프라스트럭처 영역을 모두 포함한다. 
각 바운디드 컨텍스트는 도메인에 알맞은 아키텍처를 사용한다. 
### CQRS 패턴
상태를 변경하는 명령 기능과 내용을 조회하는 쿼리 기능을 위한 모델을 구분하는 패턴 
각 바운디드 컨텍스트는 서로 다른 기술을 사용할 수도 있다. 
```
웹 MVC 
스프링 MVC를 사용하고 리포지터리 구현 기술로는 JPA/하이버네이트를 사용하는 바운디드 컨텍스트가 존재할 수도 있고, 
Netty를 이용해서 REST API를 제공하고 마이바티스를 리포지터리 구현 기술로 사용하는 바운디드 컨텍스트가 존재할 수도 있다. 
```
## 9.4 바운디드 컨텍스트 간 통합 
두 모델간의 변환 과정이 복잡하면 변환 처리를 위한 별도 클래스를 만들고 이 클래스에서 변환을 처리한다. 
REST API를 호출하는 것은 두 바운디드 컨텍스트를 직접 통합하는 방법 
메시지 큐를 사용하는 것은 간접 통합하는 방법 
마이크로 서비스는 바운디드 컨텍스트와 잘 어울린다. 
각 바운디드 컨텍스트는 모델의 경계를 형성하는데 바운디드 컨텍스트를 마이크로서비스로 구현하면 자연스럽게 컨텍스트 별로 모델이 분리된다. 


## 9.5 바운디드 컨텍스트 간 관계 
두 바운디드 컨텍스트 간 관계 중 가장 흔한 관계는 한쪽에서 API를 제공하고 다른 한쪽에서 그 API를 호출하는 관계이다.(REST API가 대표적) 
상류 컴포넌트는 일종의 서비스  공급자 역할을 하며 하류 컴포넌트는 그 서비스를 사용하는 고객 역할을 한다. 
상류 컴포넌트는 보통 하류 컴포넌트가 사용할 수 있는 통신 프로토콜을 정의하고 이를 공개 한다.  
상류 팀은 여러 하류 팀의 요구사항을 수용할 수 있는 API를 만들고 이를 서비스 형태로 공개해서 서비스의 일관성을 유지할 수 있다. 
외부 시스템의 도메인 모델이 내 도메인 모델을 침범하지 않도록 막아주는 역할을 하는 안티코럽션 계층 
서로 다른 두 팀이 공유하는 모델을 공유커널이라고 한다. 
독립 방식을 수동으로 통합하는 방식 

## 9.6 컨텍스트 맵 
컨텍스트 맵은 전체 비즈니스를 조망할 수 있는 지도 
바운디드 컨텍스트의 경계가 명확하게 드러나고 서로 어떤 관계를 맺고 있는지 보여준다. 
오픈 호스트 서비스(OHS), 안티코럽션 계층(ACL)




